<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Game Táº­p GÃµ Chá»¯: Tá»« Vá»±ng</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #1a1a2e;
            color: #fff;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            overflow: hidden;
            flex-direction: column;
            text-align: center;
        }

        .game-container {
            position: relative;
            width: 90%;
            max-width: 800px;
            height: 600px;
            border: 5px solid #00bfff;
            background-color: #2e2e4a;
            box-shadow: 0 0 20px rgba(0, 191, 255, 0.5);
            overflow: hidden;
            border-radius: 10px;
        }

        .falling-char {
            position: absolute;
            top: -50px;
            font-size: 3em;
            font-weight: bold;
            color: #ffcc00;
            text-shadow: 2px 2px 5px rgba(0, 0, 0, 0.5);
            user-select: none;
            will-change: transform, top, left;
            animation: bounce 1.5s infinite;
        }

        .correct-char-display {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 2.5em;
            color: #32cd32;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.5);
            letter-spacing: 5px;
            opacity: 1;
            transition: opacity 0.5s ease-in-out;
        }
        
        .word-info {
            position: absolute;
            top: 20%;
            left: 50%;
            transform: translate(-50%, -50%);
            display: flex;
            flex-direction: column;
            align-items: center;
            opacity: 0.8;
            transition: opacity 0.5s ease-in-out;
        }

        .word-info .emoji {
            font-size: 5em;
            margin-bottom: 10px;
        }

        .word-info .vietnamese {
            font-size: 1.5em;
            font-weight: bold;
            color: #fff;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.5);
        }

        .game-info {
            display: flex;
            justify-content: space-around;
            width: 100%;
            max-width: 800px;
            margin-top: 20px;
        }

        .controls {
            margin-top: 20px;
            display: flex;
            gap: 20px;
        }

        .btn {
            padding: 15px 30px;
            font-size: 1.2em;
            font-weight: bold;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .btn-start {
            background-image: linear-gradient(to right, #00bfff, #0073e6);
            color: white;
        }

        .btn-reset {
            background-image: linear-gradient(to right, #ff416c, #ff4b2b);
            color: white;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }

        #score-display {
            font-size: 2em;
            font-weight: bold;
            color: #f7b731;
            margin-top: 20px;
        }
        
        .main-menu {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            width: 100%;
            height: 100%;
        }

        .firework {
            position: absolute;
            width: 10px;
            height: 10px;
            background-color: #fff;
            border-radius: 50%;
            opacity: 0;
            animation: firework-burst 1s forwards;
            z-index: 100;
        }
        
        #end-game-message {
            font-size: 2.5em;
            font-weight: bold;
            color: #fff;
            text-shadow: 2px 2px 5px rgba(0, 0, 0, 0.5);
            animation: bounce 2s infinite;
        }

        @keyframes firework-burst {
            0% {
                transform: scale(0);
                opacity: 1;
            }
            100% {
                transform: scale(2.5);
                opacity: 0;
            }
        }

        @keyframes bounce {
            0%, 100% {
                transform: translateY(0);
            }
            50% {
                transform: translateY(-10px);
            }
        }
    </style>
</head>
<body>

    <div class="game-container">
        <!-- Menu chÃ­nh sáº½ Ä‘Æ°á»£c hiá»ƒn thá»‹ khi game khÃ´ng cháº¡y -->
        <div id="main-menu" class="main-menu">
            <h1>Game GÃµ Tá»« Vá»±ng</h1>
            <p>Báº¥m Báº¯t Ä‘áº§u Ä‘á»ƒ chÆ¡i</p>
        </div>
        <!-- ThÃ´ng bÃ¡o káº¿t thÃºc game -->
        <div id="end-game-message" style="display: none;">
            ChÃºc má»«ng! Báº¡n Ä‘Ã£ hoÃ n thÃ nh táº¥t cáº£ cÃ¡c tá»«!
        </div>
        
        <!-- Hiá»ƒn thá»‹ emoji vÃ  nghÄ©a tiáº¿ng Viá»‡t -->
        <div id="word-info" class="word-info">
            <span id="word-emoji" class="emoji"></span>
            <span id="word-vietnamese" class="vietnamese"></span>
        </div>
        
        <!-- Chá»¯ rÆ¡i sáº½ Ä‘Æ°á»£c thÃªm vÃ o Ä‘Ã¢y báº±ng JS -->
        <div id="correct-char-display" class="correct-char-display"></div>
    </div>

    <div class="game-info">
        <h2 id="current-word">Sáºµn sÃ ng!</h2>
        <h2 id="score-display">Tá»« hoÃ n thÃ nh: 0</h2>
    </div>

    <div class="controls">
        <button id="start-btn" class="btn btn-start">Báº¯t Ä‘áº§u</button>
        <button id="reset-btn" class="btn btn-reset">ChÆ¡i láº¡i</button>
    </div>

    <script>
        // Danh sÃ¡ch cÃ¡c tá»« vá»±ng vá»›i nghÄ©a tiáº¿ng Viá»‡t vÃ  emoji
        const words = [
            { english: "alligator", vietnamese: "cÃ¡ sáº¥u", emoji: "ðŸŠ" },
            { english: "ant", vietnamese: "con kiáº¿n", emoji: "ðŸœ" },
            { english: "apple", vietnamese: "quáº£ tÃ¡o", emoji: "ðŸŽ" },
            { english: "ball", vietnamese: "quáº£ bÃ³ng", emoji: "âš½" },
            { english: "banana", vietnamese: "quáº£ chuá»‘i", emoji: "ðŸŒ" },
            { english: "bear", vietnamese: "con gáº¥u", emoji: "ðŸ»" },
            { english: "car", vietnamese: "Ã´ tÃ´", emoji: "ðŸš—" },
            { english: "cat", vietnamese: "con mÃ¨o", emoji: "ðŸˆ" },
            { english: "cow", vietnamese: "con bÃ²", emoji: "ðŸ„" },
            { english: "dog", vietnamese: "con chÃ³", emoji: "ðŸ•" },
            { english: "drum", vietnamese: "trá»‘ng", emoji: "ðŸ¥" },
            { english: "duck", vietnamese: "con vá»‹t", emoji: "ðŸ¦†" },
            { english: "ear", vietnamese: "cÃ¡i tai", emoji: "ðŸ‘‚" },
            { english: "egg", vietnamese: "quáº£ trá»©ng", emoji: "ðŸ¥š" },
            { english: "elephant", vietnamese: "con voi", emoji: "ðŸ˜" },
            { english: "fish", vietnamese: "con cÃ¡", emoji: "ðŸŸ" },
            { english: "frog", vietnamese: "con áº¿ch", emoji: "ðŸ¸" },
            { english: "gift", vietnamese: "quÃ  táº·ng", emoji: "ðŸŽ" },
            { english: "goat", vietnamese: "con dÃª", emoji: "ðŸ" },
            { english: "bunch of grapes", vietnamese: "chÃ¹m nho", emoji: "ðŸ‡" },
            { english: "hat", vietnamese: "cÃ¡i mÅ©", emoji: "ðŸŽ©" },
            { english: "horse", vietnamese: "con ngá»±a", emoji: "ðŸŽ" },
            { english: "house", vietnamese: "ngÃ´i nhÃ ", emoji: "ðŸ " },
            { english: "ice cream", vietnamese: "kem", emoji: "ðŸ¦" },
            { english: "insect", vietnamese: "cÃ´n trÃ¹ng", emoji: "ðŸ›" },
            { english: "kangaroo", vietnamese: "chuá»™t tÃºi", emoji: "ðŸ¦˜" },
            { english: "key", vietnamese: "chÃ¬a khÃ³a", emoji: "ðŸ”‘" },
            { english: "kite", vietnamese: "cÃ¡nh diá»u", emoji: "ðŸª" },
            { english: "leaf", vietnamese: "cÃ¡i lÃ¡", emoji: "ðŸƒ" },
            { english: "lion", vietnamese: "con sÆ° tá»­", emoji: "ðŸ¦" },
            { english: "milk", vietnamese: "sá»¯a", emoji: "ðŸ¥›" },
            { english: "moon", vietnamese: "máº·t trÄƒng", emoji: "ðŸŒ•" },
            { english: "monkey", vietnamese: "con khá»‰", emoji: "ðŸ’" },
            { english: "net", vietnamese: "cÃ¡i lÆ°á»›i", emoji: "ðŸ¥…" },
            { english: "nose", vietnamese: "cÃ¡i mÅ©i", emoji: "ðŸ‘ƒ" },
            { english: "octopus", vietnamese: "báº¡ch tuá»™c", emoji: "ðŸ™" },
            { english: "orange", vietnamese: "quáº£ cam", emoji: "ðŸŠ" },
            { english: "owl", vietnamese: "cÃº mÃ¨o", emoji: "ðŸ¦‰" },
            { english: "pen", vietnamese: "cÃ¢y bÃºt", emoji: "ðŸ–‹ï¸" },
            { english: "pig", vietnamese: "con lá»£n", emoji: "ðŸ·" },
            { english: "pizza", vietnamese: "bÃ¡nh pizza", emoji: "ðŸ•" },
            { english: "rabbit", vietnamese: "con thá»", emoji: "ðŸ‡" },
            { english: "robot", vietnamese: "ngÆ°á»i mÃ¡y", emoji: "ðŸ¤–" },
            { english: "sock", vietnamese: "táº¥t", emoji: "ðŸ§¦" },
            { english: "star", vietnamese: "ngÃ´i sao", emoji: "â­" },
            { english: "sun", vietnamese: "máº·t trá»i", emoji: "â˜€ï¸" },
            { english: "tiger", vietnamese: "há»•", emoji: "ðŸ…" },
            { english: "turtle", vietnamese: "rÃ¹a", emoji: "ðŸ¢" },
            { english: "umbrella", vietnamese: "cÃ¡i Ã´", emoji: "â˜‚ï¸" },
            { english: "unicorn", vietnamese: "kÃ¬ lÃ¢n", emoji: "ðŸ¦„" },
            { english: "uniform", vietnamese: "Ä‘á»“ng phá»¥c", emoji: "ðŸ‘•" },
            { english: "van", vietnamese: "xe van", emoji: "ðŸš" },
            { english: "violin", vietnamese: "Ä‘Ã n violin", emoji: "ðŸŽ»" },
            { english: "watch", vietnamese: "Ä‘á»“ng há»“ Ä‘eo tay", emoji: "âŒš" },
            { english: "whale", vietnamese: "cÃ¡ voi", emoji: "ðŸ³" },
            { english: "yo-yo", vietnamese: "Ä‘á»“ chÆ¡i yoyo", emoji: "ðŸª€" },
            { english: "zebra", vietnamese: "ngá»±a váº±n", emoji: "ðŸ¦“" }
        ];

        // Láº¥y cÃ¡c pháº§n tá»­ DOM cáº§n thiáº¿t
        const gameContainer = document.querySelector('.game-container');
        const startBtn = document.getElementById('start-btn');
        const resetBtn = document.getElementById('reset-btn');
        const scoreDisplay = document.getElementById('score-display');
        const currentWordDisplay = document.getElementById('current-word');
        const correctCharDisplay = document.getElementById('correct-char-display');
        const mainMenu = document.getElementById('main-menu');
        const endGameMessage = document.getElementById('end-game-message');
        const wordInfo = document.getElementById('word-info');
        const wordEmoji = document.getElementById('word-emoji');
        const wordVietnamese = document.getElementById('word-vietnamese');
        
        // CÃ¡c biáº¿n tráº¡ng thÃ¡i cá»§a game
        let currentWordChars = [];
        let wordIndex = 0;
        let score = 0;
        let fallingChars = [];
        let isGameRunning = false;
        let fireworkCount = 0;
        let animationFrames = [];
        let currentWordDataIndex = 0;
        let nextWordTimeoutId = null;

        /**
         * Táº¡o má»™t chá»¯ cÃ¡i rÆ¡i tá»« trÃªn xuá»‘ng, di chuyá»ƒn ngang theo thá»© tá»±.
         * @param {string} char - KÃ½ tá»± sáº½ Ä‘Æ°á»£c táº¡o.
         * @param {number} charIndex - Vá»‹ trÃ­ cá»§a kÃ½ tá»± trong tá»«.
         * @param {number} totalChars - Tá»•ng sá»‘ kÃ½ tá»± trong tá»«.
         */
        function createFallingChar(char, charIndex, totalChars) {
            const charElement = document.createElement('div');
            charElement.classList.add('falling-char');
            charElement.textContent = char;
            gameContainer.appendChild(charElement);

            const fallingDuration = 8000;
            const horizontalRange = gameContainer.offsetWidth - 50;
            const horizontalStep = horizontalRange / totalChars;
            const startX = horizontalStep * charIndex;
            const startTime = performance.now();

            function animateChar(currentTime) {
                if (!isGameRunning && charElement.parentElement) {
                    charElement.remove();
                    return;
                }
                
                const elapsedTime = currentTime - startTime;
                const progress = elapsedTime / fallingDuration;

                if (progress >= 1) {
                    if (charElement.parentElement) {
                        charElement.remove();
                        endWord();
                        return;
                    }
                }
                
                charElement.style.top = `${progress * gameContainer.offsetHeight}px`;
                charElement.style.left = `${startX + (progress * 10)}px`;
                
                animationFrames.push(requestAnimationFrame(animateChar));
            }

            animationFrames.push(requestAnimationFrame(animateChar));
            fallingChars.push({ element: charElement, char: char });
        }

        /**
         * Sá»­ dá»¥ng Web Speech API Ä‘á»ƒ Ä‘á»c tá»«.
         * @param {string} text - VÄƒn báº£n cáº§n Ä‘á»c.
         */
        function playWordAudio(text) {
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'en-US';
            speechSynthesis.speak(utterance);
        }

        /**
         * Báº¯t Ä‘áº§u trÃ² chÆ¡i.
         */
        function startGame() {
            if (isGameRunning) return;
            isGameRunning = true;
            mainMenu.style.display = 'none';
            endGameMessage.style.display = 'none';
            score = 0;
            currentWordDataIndex = 0;
            updateScoreDisplay();
            startNewWord();
            document.addEventListener('keydown', handleKeyPress);
            startBtn.style.display = 'none';
            resetBtn.style.display = 'block';
        }

        /**
         * Báº¯t Ä‘áº§u má»™t tá»« má»›i.
         */
        function startNewWord() {
            if (!isGameRunning) {
                return;
            }
            
            wordIndex = 0;
            
            if (currentWordDataIndex >= words.length) {
                endGame();
                return;
            }
            
            const currentWordData = words[currentWordDataIndex];
            currentWordChars = currentWordData.english.split('');

            currentWordDisplay.textContent = currentWordData.english;
            wordEmoji.textContent = currentWordData.emoji;
            wordVietnamese.textContent = currentWordData.vietnamese;
            wordInfo.style.opacity = 1;

            correctCharDisplay.textContent = '';
            
            cancelAnimations();
            gameContainer.querySelectorAll('.falling-char').forEach(char => char.remove());
            fallingChars = [];

            playWordAudio(currentWordDisplay.textContent);
            
            let delay = 0;
            const totalChars = currentWordChars.filter(char => char !== ' ').length;
            let fallingCharCount = 0;

            currentWordChars.forEach(char => {
                if (char !== ' ') {
                    setTimeout(() => {
                        createFallingChar(char.toUpperCase(), fallingCharCount, totalChars);
                        fallingCharCount++;
                    }, delay);
                    delay += 300;
                }
            });
        }

        /**
         * Káº¿t thÃºc tá»« hiá»‡n táº¡i náº¿u ngÆ°á»i chÆ¡i bá» lá»¡ má»™t chá»¯.
         */
        function endWord() {
            if(!isGameRunning) {
                return;
            }

            isGameRunning = false;
            
            cancelAnimations();
            fallingChars.forEach(c => c.element.remove());
            fallingChars = [];
            
            nextWordTimeoutId = setTimeout(() => {
                isGameRunning = true;
                startNewWord();
            }, 2000);
        }

        /**
         * Xá»­ lÃ½ sá»± kiá»‡n khi ngÆ°á»i chÆ¡i báº¥m phÃ­m.
         * @param {KeyboardEvent} e - Sá»± kiá»‡n bÃ n phÃ­m.
         */
        function handleKeyPress(e) {
            if (!isGameRunning || wordIndex >= currentWordChars.length) {
                return;
            }

            while (currentWordChars[wordIndex] === ' ' && wordIndex < currentWordChars.length) {
                correctCharDisplay.textContent += ' ';
                wordIndex++;
            }

            if (wordIndex >= currentWordChars.length) {
                completeWord();
                return;
            }

            const keyPressed = e.key.toUpperCase();
            const targetChar = currentWordChars[wordIndex].toUpperCase();

            if (keyPressed === targetChar) {
                const charToFindIndex = fallingChars.findIndex(c => c.char.toUpperCase() === targetChar);
                
                if (charToFindIndex !== -1) {
                    const charToFind = fallingChars[charToFindIndex];
                    charToFind.element.remove();
                    fallingChars.splice(charToFindIndex, 1);
                    
                    correctCharDisplay.textContent += currentWordChars[wordIndex];
                    wordIndex++;
                    
                    while (currentWordChars[wordIndex] === ' ' && wordIndex < currentWordChars.length) {
                        correctCharDisplay.textContent += ' ';
                        wordIndex++;
                    }

                    if (wordIndex >= currentWordChars.length) {
                        completeWord();
                    }
                }
            }
        }

        /**
         * Xá»­ lÃ½ khi ngÆ°á»i chÆ¡i hoÃ n thÃ nh má»™t tá»«.
         */
        function completeWord() {
            score++;
            currentWordDataIndex++;
            updateScoreDisplay();
            playFireworks();
            
            isGameRunning = false;
            nextWordTimeoutId = setTimeout(() => {
                isGameRunning = true;
                startNewWord();
            }, 4000);
        }
        
        /**
         * Xá»­ lÃ½ khi ngÆ°á»i chÆ¡i hoÃ n thÃ nh táº¥t cáº£ cÃ¡c tá»«.
         */
        function endGame() {
            isGameRunning = false;
            currentWordDisplay.textContent = 'TrÃ² chÆ¡i káº¿t thÃºc!';
            correctCharDisplay.textContent = '';
            wordInfo.style.opacity = 0;
            playFireworks();
            endGameMessage.style.display = 'block';
        }

        /**
         * Cáº­p nháº­t sá»‘ tá»« hoÃ n thÃ nh trÃªn mÃ n hÃ¬nh.
         */
        function updateScoreDisplay() {
            scoreDisplay.textContent = `Tá»« hoÃ n thÃ nh: ${score}`;
        }
        
        /**
         * Báº¯t Ä‘áº§u hiá»‡u á»©ng phÃ¡o hoa.
         */
        function playFireworks() {
            fireworkCount = 0;
            triggerFireworkBurst();
        }

        /**
         * KÃ­ch hoáº¡t má»™t Ä‘á»£t phÃ¡o hoa.
         */
        function triggerFireworkBurst() {
            if (fireworkCount >= 3) return;
            fireworkCount++;
            for (let i = 0; i < 50; i++) {
                createFirework();
            }
            setTimeout(triggerFireworkBurst, 1000);
        }

        /**
         * Táº¡o má»™t háº¡t phÃ¡o hoa Ä‘Æ¡n láº».
         */
        function createFirework() {
            const firework = document.createElement('div');
            firework.classList.add('firework');
            const x = Math.random() * gameContainer.offsetWidth;
            const y = Math.random() * gameContainer.offsetHeight;
            firework.style.left = `${x}px`;
            firework.style.top = `${y}px`;
            gameContainer.appendChild(firework);

            const size = Math.random() * 10 + 5;
            firework.style.width = `${size}px`;
            firework.style.height = `${size}px`;
            firework.style.backgroundColor = `hsl(${Math.random() * 360}, 100%, 50%)`;
            
            firework.animate([
                { transform: 'scale(0)', opacity: 1 },
                { transform: 'scale(1.5)', opacity: 0 }
            ], {
                duration: 1000,
                easing: 'ease-out'
            }).onfinish = () => firework.remove();
        }

        /**
         * Há»§y táº¥t cáº£ cÃ¡c animation frame Ä‘ang cháº¡y
         */
        function cancelAnimations() {
            animationFrames.forEach(frame => cancelAnimationFrame(frame));
            animationFrames = [];
        }

        /**
         * Äáº·t láº¡i trÃ² chÆ¡i vá» tráº¡ng thÃ¡i ban Ä‘áº§u.
         */
        function resetGame() {
            isGameRunning = false;
            score = 0;
            updateScoreDisplay();
            currentWordDisplay.textContent = 'Sáºµn sÃ ng!';
            correctCharDisplay.textContent = '';
            wordInfo.style.opacity = 0;
            
            if (nextWordTimeoutId) {
                clearTimeout(nextWordTimeoutId);
            }

            mainMenu.style.display = 'flex';
            endGameMessage.style.display = 'none';
            startBtn.style.display = 'block';
            resetBtn.style.display = 'none';
            
            cancelAnimations();
            gameContainer.querySelectorAll('.falling-char').forEach(char => char.remove());
            fallingChars = [];
            
            document.removeEventListener('keydown', handleKeyPress);
            speechSynthesis.cancel();
            
            document.querySelectorAll('.firework').forEach(fw => fw.remove());
        }

        // Gáº¯n sá»± kiá»‡n click cho cÃ¡c nÃºt
        startBtn.addEventListener('click', startGame);
        resetBtn.addEventListener('click', resetGame);

        // Khá»Ÿi táº¡o game khi load trang
        resetGame();
    </script>
</body>
</html>
